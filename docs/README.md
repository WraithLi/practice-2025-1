# –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –±–æ—Ç–∞ "–ö—Ç–æ —è?"

| –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ö–æ–¥ |
|--------------|-----|
| **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫** | ```python<br>import json<br>import random<br>from aiogram import Bot, Dispatcher, types<br>from aiogram.filters import Command, StateFilter<br>from aiogram.fsm.state import State, StatesGroup<br>from aiogram.fsm.context import FSMContext<br>from aiogram.fsm.storage.memory import MemoryStorage<br>from dotenv import load_dotenv<br>import os<br>``` |
| **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**<br>- –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Ç–æ–∫–µ–Ω –±–æ—Ç–∞)<br>- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏–∑ JSON-—Ñ–∞–π–ª–∞<br>- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (MemoryStorage) | ```python<br># –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è<br>load_dotenv()<br><br># –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π<br>with open("characters.json", "r", encoding="utf-8") as f:<br>    CHARACTERS = json.load(f)<br><br># –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞<br>TOKEN = os.getenv("BOT_TOKEN")<br>bot = Bot(token=TOKEN)<br>storage = MemoryStorage()<br>dp = Dispatcher(storage=storage)<br><br># –°–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã<br>class GameState(StatesGroup):<br>    playing = State()<br>``` |
| **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**<br>/start - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ<br>/play - –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É<br>/surrender - —Å–¥–∞—Ç—å—Å—è (—Ç–æ–ª—å–∫–æ –≤ –∏–≥—Ä–µ)<br>/stats - –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–±–µ–¥<br>/help - –ø–æ–º–æ—â—å (—Ç–æ–ª—å–∫–æ –≤–Ω–µ –∏–≥—Ä—ã) | ```python<br># –ö–æ–º–∞–Ω–¥–∞ /start<br>@dp.message(Command("start"))<br>async def start(message: types.Message):<br>    await message.answer(<br>        "üé≠ –ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è –∏–≥—Ä—ã '–ö—Ç–æ —è?'\n\n"<br>        "–Ø –∑–∞–≥–∞–¥–∞—é –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, –∞ —Ç—ã –¥–æ–ª–∂–µ–Ω —É–≥–∞–¥–∞—Ç—å –µ–≥–æ..."<br>    )<br><br># –ö–æ–º–∞–Ω–¥–∞ /play<br>@dp.message(Command("play"))<br>async def play_game(message: types.Message, state: FSMContext):<br>    await state.set_state(GameState.playing)<br>    character = random.choice(CHARACTERS)<br>    await state.update_data(<br>        character=character,<br>        questions=0<br>    )<br>    await message.answer("üéÆ –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –Ø –∑–∞–≥–∞–¥–∞–ª –ø–µ—Ä—Å–æ–Ω–∞–∂–∞...")<br><br># –ö–æ–º–∞–Ω–¥–∞ /stats<br>@dp.message(Command("stats"))<br>async def show_stats(message: types.Message):<br>    wins = user_stats.get(message.from_user.id, 0)<br>    await message.answer(f"üèÜ –¢–≤–æ—ë –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥: {wins}")<br><br># –ö–æ–º–∞–Ω–¥–∞ /help<br>@dp.message(Command("help"), ~StateFilter(GameState.playing))<br>async def help_cmd(message: types.Message):<br>    await message.answer("–ü–æ–º–æ—â—å: /play - –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É")<br>``` |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤**<br>–û—Å–Ω–æ–≤–Ω–æ–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –∏ –¥–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã. –°–æ–¥–µ—Ä–∂–∏—Ç –±–æ–ª–µ–µ 20 –≤–æ–ø—Ä–æ—Å–æ–≤ | ```python<br>@dp.message(GameState.playing)<br>async def handle_question(message: types.Message, state: FSMContext):<br>    data = await state.get_data()<br>    character = data["character"]<br>    questions = data["questions"] + 1<br>    question = message.text.lower()<br><br>    if question.startswith("/"):<br>        return<br><br>    await state.update_data(questions=questions)<br><br>    if character.lower() in question:<br>        user_id = message.from_user.id<br>        user_stats[user_id] = user_stats.get(user_id, 0) + 1<br>        await message.answer(f"üéâ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –≠—Ç–æ {character}!...")<br>        await state.clear()<br>        return<br><br>    # –õ–æ–≥–∏–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã<br>    answer = "–ù–µ –∑–Ω–∞—é"<br>    if "—á–µ–ª–æ–≤–µ–∫" in question:<br>        answer = "–î–∞" if character in ["–õ–µ–æ–Ω –ö–µ–Ω–Ω–µ–¥–∏", ...] else "–ù–µ—Ç"<br>    elif "–∂–∏–≤–æ—Ç–Ω–æ–µ" in question:<br>        answer = "–î–∞" if character in ["–ö–æ—Ç –≤ —Å–∞–ø–æ–≥–∞—Ö"] else "–ù–µ—Ç"<br>    # ... –¥—Ä—É–≥–∏–µ —É—Å–ª–æ–≤–∏—è<br>    await message.answer(answer)<br>``` |
| **–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞** | ```python<br>if __name__ == "__main__":<br>    dp.run_polling(bot, skip_updates=True)<br>``` |
